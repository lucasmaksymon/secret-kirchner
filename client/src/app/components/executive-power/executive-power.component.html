<div class="executive-power-container card" *ngIf="gameState$ | async as gameState">
  <h3 class="text-center">üíº Poder Presidencial</h3>

  <div *ngIf="isPresident() && getPowerInfo() as power" class="power-section">
    <div class="power-info">
      <div class="power-icon">{{ power.icon }}</div>
      <h4>{{ power.name }}</h4>
      <p class="power-description">
        {{ power.description }}
      </p>
    </div>

    <!-- Peek: No requiere selecci√≥n -->
    <div *ngIf="getCurrentPower() === 'peek'" class="power-actions mt-3">
      <button 
        class="btn btn-primary btn-large"
        (click)="executePower()"
      >
        {{ power.icon }} Ejecutar {{ power.name }}
      </button>
      <p class="text-muted mt-2">
        Ver√°s las pr√≥ximas 3 cartas del mazo en secreto
      </p>
      
      <!-- Mostrar resultado de peek -->
      <div *ngIf="peekResult$ | async as peekCards" class="peek-result mt-3">
        <h5>üìä Cartas vistas (en orden):</h5>
        <div class="peek-cards">
          <div 
            *ngFor="let card of peekCards; let i = index"
            class="peek-card"
            [class.libertario]="card.type === 'libertario'"
            [class.kirchnerista]="card.type === 'kirchnerista'"
          >
            <div class="peek-card-number">{{ i + 1 }}</div>
            <div class="peek-card-icon">
              {{ card.type === 'libertario' ? 'ü¶Ö' : '‚úä' }}
            </div>
            <div class="peek-card-type">
              {{ card.type === 'libertario' ? 'LIBERTARIO' : 'KIRCHNERISTA' }}
            </div>
            <div class="peek-card-name">{{ card.name }}</div>
          </div>
        </div>
        <p class="text-muted mt-2 small">
          ‚ö†Ô∏è Esta informaci√≥n es solo para vos. Pod√©s mentir sobre lo que viste.
        </p>
      </div>
    </div>

    <!-- Otros poderes: Requieren selecci√≥n de jugador -->
    <div *ngIf="requiresPlayerSelection()" class="player-selection mt-3">
      <h5 *ngIf="getCurrentPower() === 'investigate'">Seleccion√° un jugador para investigar:</h5>
      <h5 *ngIf="getCurrentPower() === 'special-election'">Seleccion√° al pr√≥ximo Presidente:</h5>
      <h5 *ngIf="getCurrentPower() === 'execution'">Seleccion√° un jugador para ejecutar:</h5>
      
      <div class="player-grid">
        <div 
          *ngFor="let player of getEligiblePlayers()"
          class="player-option"
          [class.selected]="selectedPlayerId === player.id"
          [class.disabled]="!canSelectPlayer(player)"
          (click)="canSelectPlayer(player) && selectPlayer(player.id)"
        >
          <span class="player-name">{{ player.name }}</span>
          <span *ngIf="player.isAI" class="ai-badge">ü§ñ</span>
          <span *ngIf="selectedPlayerId === player.id" class="selected-badge">‚úì</span>
        </div>
      </div>
    </div>

    <div *ngIf="requiresPlayerSelection()" class="power-actions mt-3">
      <button 
        class="btn"
        [class.btn-primary]="getCurrentPower() === 'investigate' || getCurrentPower() === 'special-election'"
        [class.btn-danger]="getCurrentPower() === 'execution'"
        [class.btn-large]="true"
        [disabled]="!selectedPlayerId"
        (click)="executePower()"
      >
        {{ power.icon }} Ejecutar {{ power.name }}
      </button>
      <p *ngIf="getCurrentPower() === 'execution'" class="text-muted mt-2">
        ‚ö†Ô∏è Esta acci√≥n no se puede deshacer
      </p>
      <p *ngIf="getCurrentPower() === 'investigate'" class="text-muted mt-2">
        Ver√°s la lealtad del jugador seleccionado (pero no si es El Jefe)
      </p>
      
      <!-- Mostrar resultado de investigaci√≥n -->
      <div *ngIf="getCurrentPower() === 'investigate' && (investigateResult$ | async) as result" class="investigate-result mt-3">
        <div class="alert alert-info">
          <h5>üïµÔ∏è Resultado de la Investigaci√≥n</h5>
          <p><strong>{{ result.playerName }}</strong> es <strong>{{ result.loyalty === 'libertarios' ? 'LIBERTARIO' : 'KIRCHNERISTA' }}</strong></p>
          <p class="small text-muted mt-2">
            ‚ö†Ô∏è Esta informaci√≥n es solo para vos. Pod√©s compartir o mentir sobre el resultado.
          </p>
        </div>
      </div>
      <p *ngIf="getCurrentPower() === 'special-election'" class="text-muted mt-2">
        El jugador seleccionado ser√° el pr√≥ximo Presidente
      </p>
    </div>
  </div>

  <div *ngIf="!isPresident()" class="waiting-section text-center">
    <div class="spinner">‚è≥</div>
    <p class="mt-3">Esperando a que el Presidente ejecute su poder...</p>
    <p *ngIf="getPowerInfo() as power" class="text-muted mt-2">
      {{ power.icon }} {{ power.name }}
    </p>
  </div>
</div>

